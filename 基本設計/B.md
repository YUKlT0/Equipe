B
## 3. 機能設計

### 3.1. 機能一覧

- **認証機能**
    - ログイン/ログアウト機能
    - ユーザー情報登録機能
- **商品表示機能**
    - トップページ・おすすめ情報表示
    - 商品一覧ページ・カテゴリ一覧表示・商品、カテゴリ検索機能
    - 商品詳細ページ・商品ID、商品詳細情報表示機能
    - マイページ　購入履歴、登録情報表示、変更
- **カート機能**
    - 商品追加機能・商品リスト情報更新機能・カートアイコン反映機能
    - カート内商品表示機能・カート内情報維持機能
    - 
- **注文機能**
    - 個人情報入力機能・入力確認画面表示
    - 注文情報・配送情報画面表示
    - 支払情報入力、選択機能
- **スマホ・タブレット対応機能**
    - ページでレイアウト最適化表示・スマホ特有のUI機能
    - 
- **商品管理機能(管理者向け)**
    - 商品情報追加、削除機能・編集入力機能・商品在庫管理
    - 注文情報確認機能

### 3.2. 機能構成図

<div class="mermaid">
graph TD
    A[ECサイト] --> B(認証機能)
    A --> C(商品表示機能)
    A --> F(スマホ対応機能)
    

    subgraph B[認証機能]
        B1[ログイン機能]
        B2[ログアウト機能]
        B3[ユーザー登録機能]
     end

    subgraph C[商品表示機能]
        C1[トップページ・おすすめ表示]
        C2[商品一覧ページ・カテゴリ一覧表示]
        C3[商品検索機能]
        C4[商品詳細ページ・詳細情報表示]
        C5[マイページ]
    end

    subgraph D[カート機能]
        D1[商品追加機能]
        D2[カート情報更新・アイコン反映]
        D3[カート内商品表示]
        D4[カート情報保持]
    end

    subgraph E[注文機能]
        E1[個人情報入力]
        E2[入力確認画面表示]
        E3[注文情報・配送情報確認]
        E4[支払情報入力、選択機能]
    end

    subgraph F[スマホ・タブレット対応機能]
        F1[レスポンシブレイアウト最適化]
        F2[スマホ専用UI]
    end

     %% 管理者機能を明示的に右下へ分離
    Z[管理者専用画面] --> G

    subgraph G[商品管理機能（管理者向け）]
        G1[商品情報追加、削除]
        G2[編集情報入力機能]
        G3[商品在庫管理機能]
        G4[注文情報確認機能]

    end

    B --> C
    C --> D
    D --> E
    F --> B
    F --> C
    

    style A fill:#ffd,stroke:#333,stroke-width:2px
</div>

### 3.3. 主要機能フロー

システムで行われる代表的な業務フローを示す。

#### 3.3.1. ECサイト一般ユーザー利用フロー

<div class="mermaid">
sequenceDiagram
participant ユーザー as ECサイト利用者
participant サイト as ECサイト
participant カート as カート機能
participant 注文処理 as 注文機能
participant メール as メールサーバ

ユーザー ->> サイト: トップページにアクセス
サイト ->> サイト: おすすめ商品・カテゴリを表示

ユーザー ->> サイト: 商品検索・カテゴリ選択
サイト ->> ユーザー: 商品一覧を表示

ユーザー ->> サイト: 商品詳細ページを閲覧
ユーザー ->> カート: 商品をカートに追加

alt 在庫あり
カート ->> カート: 商品リストを更新
カート ->> ユーザー: カートに追加完了メッセージを表示
else 在庫切れ
カート ->> カート: 処理中断（在庫チェックNG）
カート ->> ユーザー: 「🎉「完売ィィィッ！！」」エラーメッセージを表示
ユーザー ->> サイト: 他の商品を探す

end

opt 在庫がありカートに追加できた場合
ユーザー ->> カート: カート内容を確認
カート ->> ユーザー: 商品一覧・金額を表示

ユーザー ->> 注文処理: 購入手続き開始（個人情報入力）
注文処理 ->> ユーザー: 入力確認画面を表示

ユーザー ->> 注文処理: 注文確定
注文処理 ->> 注文処理: 注文データ保存・配送処理
注文処理 ->> メール: 注文完了メールを送信
メール ->> ユーザー: 注文確認メールを受信
end
</div>

#### 3.3.2. ECサイト管理者利用フロー
<div class="mermaid">
sequenceDiagram
participant 管理者 as 管理者
participant 管理画面 as 管理者画面
participant 倉庫 as　仕入先
participant DB as ECサイト

loop 定期チェック or アラート通知時
    管理者 ->> 管理画面: 在庫状況を確認
end

alt 在庫が閾値未満
    管理者 ->> 倉庫: 発注依頼（システム外）
    倉庫 ->> 管理者: 納品完了
    管理者 ->> 管理画面: 入庫処理（数量入力）
    管理画面 ->> DB: 在庫数を更新
    DB ->> 管理画面: 更新完了レスポンス
    管理画面 ->> 管理者: 更新完了メッセージ
else 閾値以上
    管理者 ->> 管理者: 数量入力調整のみ
end
</div>
