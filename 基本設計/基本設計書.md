# ECサイト　基本設計書

| ドキュメントバージョン | 1.0                                         |
| :--------------------- | :------------------------------------------ |
| 作成日                 | 2025年7月03日                               |
| 作成チーム             | チームEquipe                                |
| 承認者                 | 〇〇 〇〇様                                 |
| 更新履歴               | 2025/04/20: Ver.1.0 初版作成 (チームEquipe) |

---

## 1. はじめに

### 1.1. 本書の目的

本書は、株式会社〇〇が開発を進める「ＥＣサイト」新規構築プロジェクトにおける基本設計の内容を定義するものである。要件定義書で定められた要件に基づき、システムの全体構成、主要な機能、画面、データ、非機能要件への対応方針などを明確にし、後続の詳細設計、実装、テスト工程のインプットとすることを目的とする。

### 1.2. プロジェクト概要

本プロジェクトは株式会社〇〇のシンプルで質のいい雑貨をより多くの顧客に届けることを目的とし、新規ECサイトを開発・導入するものである。実店舗中心の販売から脱却し、オンラインでの商品販売を可能にすることで、販路と顧客層の拡大を図る。

### 1.3. 前提知識

本書を読むにあたり、以下の知識を有していることを前提とする。

- 本プロジェクトの要件定義書の内容
- Webアプリケーション開発の基本的な知識 (HTTP, HTML, CSS, JavaScript)
- REST API の基本的な概念
- Java および Spring Boot フレームワークの基本的な知識
- リレーショナルデータベースの基本的な知識

## 2. システム概要

### 2.1. システムの目的

本システムは、販売チャネルの確立、商品の魅力訴求、販売業務の効率化を目的とする。

### 2.2. 対象ユーザー

本システムの主な利用者は以下の通り。

- **(1)管理者**:サイトの全体的な管理・運用を行う
- **(2)一般消費者（20代後半～40代くらいの男女）**:商品を購入する消費者

### 2.3. システム構成図

<div class="mermaid">
graph LR
  subgraph クライアント環境
    PC[PCブラウザ<br>（Chrome / Edge）]
    SP[スマートフォン<br>（Safari / Chrome）]

  end

INTERNET[インターネット]

  subgraph AWS環境[（クラウド）]
    LB[ALB （ロードバランサ）]
    WEB[Web/APサーバ　`<br>`（Java）]
    DB[DBサーバ`<br>`（MySQL 8.0）]
    FS[ファイルストレージ`<br>`（S3等）]
    WAF[WAF`<br>`（AWS WAF / Cloudflare）]
  end

  PC -->|HTTPS| INTERNET -->|TLS通信| WAF --> LB --> WEB
  SP -->|HTTPS| INTERNET

  WEB -->|API / DB接続| DB
  WEB -->|画像取得・保存| FS

  style PC fill:#ffffcc,stroke:#333,stroke-width:1px
  style SP fill:#ffffcc,stroke:#333,stroke-width:1px
  style INTERNET fill:#eee,stroke:#999,stroke-width:1px,stroke-dasharray: 5 5
  style WAF fill:#ffcc99,stroke:#333,stroke-width:1px
  style LB fill:#cce5ff,stroke:#333,stroke-width:2px
  style WEB fill:#cce5ff,stroke:#333,stroke-width:2px
  style DB fill:#ccffcc,stroke:#333,stroke-width:1px
  style FS fill:#eeeeee,stroke:#333,stroke-width:1px

</div>

- **クライアント環境**:
  PCブラウザ（Chrome/Edge）あるいはスマートフォン（Safari/Chrome）
- **クラウド**:
  Web/APサーバー：ECサイトのアプリケーションをホスト
  DBサーバー：商品情報、注文情報などを管理
  ファイルストレージ（オプション）：商品画像などの静的ファイルを格納
- **インターネット**:
  クライアントからWebサーバーへはHTTPS通信
  Webサーバーから各サーバーへは内部接続

### 2.4. 外部インターフェース概要

- **CSVファイル取り込み** 
    - 商品情報の初期登録・一括更新のためにCSVファイルをアップロード可能。
    - 管理画面から操作し、サーバー側でパース・登録処理を行う。
- **認証サーバー（オプション）** 
    - 将来的にSSO（シングルサインオン）や社内AD連携を検討。
    - 管理者ログインの利便性向上を目的とする。

## 3. 機能設計

### 3.1. 機能一覧

- **認証機能**
  - ログイン/ログアウト機能
  - ユーザー情報登録機能
  - マイページ、登録情報表示、変更
- **商品表示機能**
  - 商品一覧ページ・カテゴリ別商品一覧表示
  - 商品詳細ページ・商品ID、写真、価格、素材、納期予定表示機能
  - 無限スクロール方式により商品表示件数を制御
- **カート機能**
  - 商品追加機能・商品削除機能・商品数量編集機能・カートアイコン反映機能
  - カート内商品表示機能
  - カート状態保持機能（セッション/ローカルストレージ対応）
  - 未ログイン状態でもカートを維持
- **注文機能**
  - 個人情報入力機能・入力確認画面表示
  - 注文情報
- **スマホ対応機能**
  - ページでレイアウト最適化表示・スマホ特有のUI機能
- **商品管理機能(管理者向け)**
  - 商品情報追加、削除機能・編集入力機能
  - 注文情報確認機能

### 3.2. 機能構成図

<div class="mermaid">
graph TD
    A[ECサイト全体]

    %% 各機能ノード
    A --> B[認証機能]
    A --> C[商品表示機能]
    A --> D[カート機能]
    A --> E[注文機能]
    A --> F[スマホ対応機能]
    A --> Z[管理者専用機能]

    %% 認証機能
    subgraph 認証機能
        B1[ログイン]
        B2[ログアウト]
        B3[ユーザー登録]
        B4[マイページ閲覧・編集]
    end
    B --> B1
    B --> B3
    B --> B4
    B --> B2

    %% 商品表示機能
    subgraph 商品表示機能
        C1[商品一覧]
        C2[カテゴリ別表示]
        C4[商品詳細]
    end
    C --> C1 --> C2 --> C4

    %% カート機能
    subgraph カート機能
        D1[商品追加・削除・数量変更]
        D2[カート内表示]
        D3[アイコン反映]
        D4[未ログインでも保持]
    end
    D --> D1 --> D2 --> D4
    D1 --> D3

    %% 注文機能
    subgraph 注文機能
        E1[個人情報入力（未ログイン時）]
        E2[入力確認]
        E3[注文確定]
        E4[注文ID・ステータス管理]
        E5[マイページからの注文（自動入力）]
    end
    E --> E1 --> E2 --> E3 --> E4
    B4 --> E5
    E5 --> E3
    %% スマホ対応機能
    subgraph スマホ対応機能
        F1[レスポンシブ最適化]
        F2[スマホ専用UI]
        F3[タップ優先レイアウト]
    end
    F --> F1
    F --> F2
    F --> F3

    %% 管理者機能
    subgraph 管理者専用機能
        G1[商品情報追加・削除]
        G2[商品編集]
        G3[注文情報確認]
    end
    Z --> G1
    Z --> G2
    Z --> G3

    %% フローとの整合リンク（コメント）
    B --> C
    B --> D
    B --> E

    C4 --> D1
    D4 --> E1

    F --> C
    F --> D
    F --> E

</div>

## 3.3. 主要機能フロー

システムで行われる代表的な業務フローを示す。

#### 3.3.1. ECサイト一般ユーザー利用フロー

<div class="mermaid">
sequenceDiagram
participant ユーザー as ECサイト利用者
participant サイト as ECサイト

alt 任意のタイミングでログイン
    ユーザー -->> サイト: ログイン
    サイト -->> ユーザー: 認証結果・マイページリンク表示
end

ユーザー ->> サイト: 商品ページにアクセス
サイト ->> ユーザー: 商品一覧を表示

ユーザー ->> サイト: 商品検索・カテゴリ選択
サイト ->> ユーザー: カテゴリ別商品一覧を表示

ユーザー ->> サイト: 商品を選択
サイト ->> ユーザー: 商品詳細ページを表示
ユーザー ->> サイト: 商品をカートに追加

alt 任意のタイミングでログイン
    ユーザー -->> サイト: ログイン
    サイト -->> ユーザー: 認証結果・マイページリンク表示
end

ユーザー ->> サイト: カート内容を確認
サイト ->> ユーザー: 商品一覧・金額を表示

ユーザー ->> サイト: 購入手続き開始（個人情報入力）
サイト ->> ユーザー: 入力確認画面を表示（キャンセル不可の注意あり）
ユーザー ->> サイト: 注文確定

</div>

#### 3.3.2. ECサイト管理者利用フロー

<div class="mermaid">
sequenceDiagram
participant 管理者 as 管理者
participant 管理画面 as 管理者画面
participant DB as ECサイト

alt 商品を新しく追加したいとき
    管理者 ->> 管理画面: 「新規商品追加」画面を開く
    管理者 ->> 管理画面: 商品名・価格・説明・画像を入力
    管理画面 ->> DB: 商品情報を登録
    DB ->> 管理画面: 登録成功レスポンス
    管理画面 ->> 管理者: 商品を追加しました
end

alt 商品情報を変更したいとき
    管理者 ->> 管理画面: 商品一覧から対象商品を選択
    管理者 ->> 管理画面: 編集内容を入力（例：価格、説明、画像など）
    管理画面 ->> DB: 商品情報を更新
    DB ->> 管理画面: 更新完了レスポンス
    管理画面 ->> 管理者: 商品情報を更新しました
end

alt 商品を削除（非公開）したいとき
    管理者 ->> 管理画面: 商品一覧から削除対象を選択
    管理者 ->> 管理画面: 「削除」または「公開停止」を実行
    管理画面 ->> DB: 対象商品を削除または非表示フラグを更新
    DB ->> 管理画面: 処理完了レスポンス
    管理画面 ->> 管理者: 商品を削除・非公開にしました
end

</div>


## 4. 画面設計

本章では、想定している主要画面のレイアウトや画面間の遷移など、UI設計の概要を示す。

### 4.1. 画面一覧

- **SC0001: ユーザーログイン画面**
  - ユーザーIDとパスワードを入力し、システムにログインする画面。新規会員登録やゲストログインも配置。
- **SC0010: 新規会員登録画面**
  - ユーザーID、パスワード、氏名、住所、メールアドレスを新規登録する画面。
- **SC0110: 商品一覧画面**
  - システムに登録されている商品を一覧表示する画面。カテゴリー絞り込み、納期情報の表示などを配置。ホーム画面の役割を果たす。
- **SC0115: カテゴリ別商品一覧画面**
  - ユーザーが選択したカテゴリで絞り込み、商品一覧画面(SC0110)と同様にシステムに登録されている商品を一覧表示する画面。
- **SC0120: 商品詳細画面**
  - 選択した商品の詳細情報（大きめの商品画像、説明、価格、素材情報など）を表示する画面。
- **SC0125: マイページ画面**
  - 会員登録をしたユーザー専用画面。
- **SC0128: 会員情報編集画面**
  - 会員登録済みのユーザーが登録内容を編集する画面。
- **SC0130: カート画面**
  - カートに追加されている商品を表示・追加・削除する画面。
- **SC0140: 注文情報入力画面**
  - 購入者氏名、購入者住所、購入者メールアドレス、配送先氏名、配送先住所、決済方法を入力・選択する画面。
- **SC0150: 注文情報確認画面**
  - 注文情報入力画面(SC0140)で入力された情報を確認し、確定させる画面。
- **SC0160: 注文完了画面**
  - 注文が正常に完了したことを伝える画面。
- **SC9001: 管理者ログイン画面**
  - 管理者用ユーザーIDとパスワードを入力し、システムにログインする画面。
- **SC9101: 管理者ダッシュボード画面**
  - 管理者向けのホーム画面。
- **SC9201: 商品情報追加・編集画面** (管理者向け)
  - 新規商品情報の追加や、商品情報の編集を行う画面。
- **SC9301: 注文情報確認画面** (管理者向け)
  - 注文状況を確認する画面。
- **SC9401: 管理者編集画面**
  - 管理者の登録や編集・削除を行う画面。
- (その他、必要に応じて画面を追加)

### 4.2. 画面遷移図

以下に、主要な画面遷移を示す。

<div class="mermaid">
graph TD
    A[SC0001: ユーザーログイン画面] -- ログイン --> C(SC0110: 商品一覧画面);

    A -- 会員登録 --> B(SC0010: 新規会員登録画面);

    B -- 自動でログイン --> C;

    A -- ゲストログイン --> C;

    C -- カテゴリ選択 --> D(SC0115: カテゴリ別商品一覧画面);
    D -- カテゴリ解除 --> C;
    D -- 商品選択 --> E(SC0120: 商品詳細画面);
    E -- 一覧へ戻る --> D;
　
    C -- マイページ選択 --> V(SC0125: マイページ画面);
    V -- 一覧へ戻る --> C;

    V -- 会員情報編集選択 --> W(SC0128: 会員情報編集画面);
    W -- マイページへ戻る --> V;

    C -- 商品選択 --> E(SC0120: 商品詳細画面);
    E -- 一覧へ戻る --> C;

    C -- カートを見る --> F(SC0130: カート画面);
    D -- カートを見る --> F;
    E -- カートを見る --> F;
    F -- 一覧へ戻る --> C;
    F -- 商品へ戻る --> E;

    F -- ログイン --> A;
    A -- 注文に進む --> G;

    F -- 注文へ進む --> G(SC0140: 注文情報入力画面);
    G -- カートへ戻る --> F;
    G -- 注文確認 --> H(SC0150: 注文情報確認画面);
    H -- 修正 --> G;
    H -- 確定させる --> I(SC0160: 注文完了画面);
    I -- 一覧へ戻る --> C;

    C -- ログアウト --> A;
    D -- ログアウト --> A;
    E -- ログアウト --> A;

    style A fill:#cce5ff,stroke:#333,stroke-width:1px
    style B fill:#cce5ff,stroke:#333,stroke-width:1px
    style C fill:#d4edda,stroke:#333,stroke-width:1px
    style D fill:#d4edda,stroke:#333,stroke-width:1px
    style E fill:#d4edda,stroke:#333,stroke-width:1px,color:#000
    style F fill:#fff3cd,stroke:#333,stroke-width:1px,color:#000
    style G fill:#fff3cd,stroke:#333,stroke-width:1px,color:#000
    style H fill:#fff3cd,stroke:#333,stroke-width:1px,color:#000
    style I fill:#fff3cd,stroke:#333,stroke-width:1px,color:#000
    style V fill:#e2d6f3,stroke:#333,stroke-width:1px,color:#000
    style W fill:#e2d6f3,stroke:#333,stroke-width:1px,color:#000

</div>

<div class="mermaid">
graph TD
    J[SC9001: 管理者ログイン画面] -- ログイン --> K(SC9101: 管理者ダッシュボード画面);
    K -- 商品情報管理選択 --> L(SC9201: 商品情報登録・編集画面);
    L -- ホームへ戻る --> K;
    K -- 注文情報確認選択 --> M(SC9301: 注文情報確認画面);
    M -- ホームへ戻る --> K;
    K -- 管理者編集選択 --> N(SC9401: 管理者編集画面);
    N -- ホームへ戻る --> K;
    K -- ログアウト --> J;
    L -- ログアウト --> J;
    M -- ログアウト --> J;

    style J fill:#cce5ff,stroke:#333,stroke-width:1px,color:#000
    style K fill:#e2e3e5,stroke:#333,stroke-width:1px,color:#000
    style L fill:#d4edda,stroke:#333,stroke-width:1px,color:#000
    style M fill:#fff3cd,stroke:#333,stroke-width:1px,color:#000
    style N fill:#e2d6f3,stroke:#333,stroke-width:1px,color:#000

</div>

### 4.3. UI/UX基本方針

本システムのユーザーインターフェースは、利用者がストレスなく操作できることを最優先に設計する。以下に、本システムにおけるUI/UX設計の基本方針を示す。

- **直感的な操作性**誰でも迷わず使えるよう、画面レイアウトやナビゲーション、ボタン配置をわかりやすく設計する。
- **統一されたデザインルール**画面間で一貫性のあるデザイン（ボタンの配置・配色、フォント、アイコンなど）を維持し、操作感を揃えることで、ユーザーの混乱を防ぐ。
- **視認性・アクセシビリティの確保**文字サイズや色のコントラストに配慮し、あらゆるユーザーが快適に情報を閲覧できるようにする。特に重要な情報やアクションボタンは視線の導線上に配置する。
- **操作に対する即時フィードバック**ユーザーのアクションに対しては、読み込み中の状態や完了・エラーなどの結果を適切なタイミングと方法で明示し、安心感を与える。
- **スマートフォン対応**
  スマートフォンで快適に利用できるよう、レスポンシブ対応を行う。タッチ操作も考慮したUI設計とする。

## 5. データ設計

本節では、システムにおける主なエンティティ間の関係と、主要なデータの流れの概要を示す。

### 5.1. 概念データモデル（ER図）

<div class="mermaid">
erDiagram
    CUSTOMER ||--o{ ORDER : "places"
    ORDER ||--|{ ORDER_DETAIL : "has"
    ORDER_DETAIL }|--|| PRODUCT : "includes"
    PRODUCT }|--|| CATEGORY : "belongs to"
    PRODUCT ||--o{ PRODUCT_IMAGE : "has"

    CUSTOMER {
        string 会員ID PK
        string 氏名
        string メールアドレス
        string ハッシュパスワード
        string 住所
        datetime 登録日時
        boolean メンバーシップ
    }

    ADMIN {
        string 管理者ID PK
        string 氏名
        string メールアドレス
        string ハッシュパスワード
        string 登録日時
    }

    ORDER {
        string 注文ID PK
        string 会員ID FK
        string 購入者氏名
        string 購入者メールアドレス
        string 購入者住所
        datetime 注文日時
        string 配送先氏名
        string 配送先住所
        decimal 送料
        decimal 合計金額
        string 決済方法
        string 注文ステータス
    }

    ORDER_DETAIL {
        string 注文詳細ID PK
        string 注文ID FK
        string 商品ID FK
        int 数量
        decimal 単価
    }

    PRODUCT {
        string 商品ID PK
        string 商品名
        string 商品説明
        decimal 価格
        string カテゴリID FK
    }

    CATEGORY {
        string カテゴリID PK
        string カテゴリ名
    }

    PRODUCT_IMAGE {
        string 画像ID PK
        string 商品ID FK
        string 画像URL
        int 表示順
    }

</div>

- **エンティティ**

  - CUSTOMER(顧客)
  - ADMIN(管理者)
  - ORDER(注文)
  - ORDER_DETAIL(注文詳細)
  - PRODUCT(商品)
  - PRODUCT_IMAGE(商品画像)
  - CATEGORY(カテゴリ)
- **リレーション**

  - 顧客は注文を行う (1対多、CUSTOMER -> ORDER)
  - 注文は複数の注文詳細を持つ (1対多、ORDER -> ORDER_DETAIL)
  - 注文詳細は商品を含む (多対1、ORDER_DETAIL -> PRODUCT)
  - 商品はカテゴリに属する (多対1、PRODUCT -> CATEGORY)
  - 商品は複数の画像を持つ (1対多、PRODUCT -> PRODUCT_IMAGE)

### 5.2. 主要テーブル概要

- **CUSTOMER (顧客テーブル)**

  - ECサイトの会員情報を管理。
  - 会員IDを主キーとし、顧客全員の情報を保持。
  - 氏名、メールアドレス、ハッシュ化パスワード、住所、登録日時、メンバーシップを保持。
  - 非会員の場合は、注文時に入力した購入者情報を注文時にパスワードはNULL、メンバーシップはfalseとして保持。
  - 会員登録が任意のため、注文時の購入者氏名・購入者住所は注文テーブルにも保持。
- **ADMIN (管理者テーブル)**

  - ECサイトの管理者情報を管理。
  - 管理者IDを主キーとして管理。
  - 氏名、メールアドレス、ハッシュ化パスワード、登録日時を保持。
- **ORDER (注文テーブル)**

  - 顧客の注文情報を管理。
  - 注文IDを主キーとし、会員IDは外部キーとして関連付ける。
  - 注文日時、送料、合計金額、決済方法、注文ステータス、購入者氏名、購入者メールアドレス、購入者住所、配送先氏名、配送先住所を保持し配送や請求の基礎情報とする。
- **ORDER_DETAIL (注文詳細テーブル)**

  - 各注文に含まれる商品ごとの詳細情報を管理。
  - 注文詳細IDを主キー、注文IDと商品IDを外部キーとして紐付け。
  - 数量、単価を保持し、複数商品の注文に対応。
- **PRODUCT (商品テーブル)**

  - ECサイトで販売する商品の情報を管理。
  - 商品IDを主キーとし、商品名、商品説明、価格を保持、外部キーとしてカテゴリIDを紐づけ。
  - 商品画像と関連付ける。
- **PRODUCT_IMAGE (商品画像テーブル)**

  - 商品に紐づく複数の画像情報を管理。
  - 画像IDを主キーとし、商品IDを外部キーとして紐付け。
  - 画像URL、表示順を保持。
- **CATEGORY (カテゴリテーブル)**

  - 商品の分類情報を管理。
  - カテゴリIDを主キーとし、カテゴリ名を保持。

### 5.3　データフロー概要

#### 例：サイトアクセスから注文完了までのデータフロー（非会員）

##### データフロー（シーケンス図）

<div class="mermaid">
sequenceDiagram
    participant ユーザー
    participant 画面
    participant フロントエンド
    participant バックエンド
    participant DB

    ユーザー->>画面: ECサイトにアクセス
    画面->>フロントエンド: 商品一覧表示要求
    フロントエンド->>バックエンド: 商品情報取得リクエスト
    バックエンド->>DB: PRODUCT, CATEGORY, PRODUCT_IMAGE を検索
    DB-->>バックエンド: 商品情報返却
    バックエンド-->>フロントエンド: 商品情報返却
    フロントエンド-->>画面: 商品一覧を表示

    ユーザー->>画面: 商品を選択し詳細を見る
    画面->>フロントエンド: 商品詳細取得
    フロントエンド->>バックエンド: 商品IDを送信
    バックエンド->>DB: PRODUCT を検索
    DB-->>バックエンド: 商品詳細返却
    バックエンド-->>フロントエンド: 商品詳細返却
    フロントエンド-->>画面: 商品詳細表示

    ユーザー->>画面: 商品をカートに追加
    画面->>フロントエンド: カートに商品情報を保持

    ユーザー->>画面: 購入手続きに進む
    画面->>フロントエンド: ユーザー情報入力（氏名・住所・メール・決済情報）
    フロントエンド->>バックエンド: 入力情報を送信

    バックエンド->>DB: ORDER を登録
    バックエンド->>DB: ORDER_DETAIL を商品ごとに登録

    DB-->>バックエンド: 登録・更新成功
    バックエンド-->>フロントエンド: 注文完了情報返却
    フロントエンド-->>画面: 注文完了画面を表示

</div>

##### **1. サイトアクセス〜商品閲覧**

1. **画面（SC0001）**
   ユーザーがブラウザでECサイトにアクセス、ログイン画面が表示されゲストを選択。
2. **アプリケーション（Frontend）**
   商品一覧を表示するためのリクエストをバックエンドへ送信。
3. **アプリケーション（Backend）**
   `PRODUCT` テーブルから商品情報を取得。
   必要に応じて `CATEGORY`, `PRODUCT_IMAGE` をJOIN。
   フロントエンドに商品情報を返却。
4. **画面（SC0110）**
   商品一覧が表示され、ユーザーが商品をクリック。
5. **アプリケーション（Frontend） → Backend**
   選択された商品IDで `PRODUCT` の詳細を取得し、商品詳細ページを表示。

##### **2. カート操作〜注文確認画面**

1. **画面（SC0120）**
   商品詳細ページで数量を選び、「カートに追加」ボタンをクリック。
2. **アプリケーション（Frontend）**
   商品ID・数量をローカルセッションに保持。
   「カートを見る」ボタンでカート内容表示。
3. **ユーザーが「購入へ進む」ボタンをクリック**
4. **画面（SC0140）**
   注文者情報入力フォームが表示され、ユーザーが氏名、メールアドレス、住所、配送方法、決済情報を入力。

##### **3. 注文確定処理**

1. **画面（SC0150）**
   内容を確認し、「注文を確定する」ボタンをクリック。
2. **アプリケーション（Backend）**
   `CUSTOMER`テーブルに氏名、メールアドレス、住所、登録日時、メンバーシップ（false）を登録。
   `ORDER` テーブルに注文基本情報を登録。
   `ORDER_DETAIL` テーブルに商品ID・数量・単価を登録。
3. **データベース（DB）**
   `ORDER`, `ORDER_DETAIL`に情報を登録。
4. **アプリケーション（Backend）**
   注文結果をフロントエンドに返却。
5. **画面（SC0160）**
   注文完了画面を表示。

#### 例：サイトアクセスからログイン、注文完了までのデータフロー（会員）

<div class="mermaid">
sequenceDiagram
    participant ユーザー
    participant 画面
    participant フロントエンド
    participant バックエンド
    participant DB

    ユーザー->>画面: ECサイトにアクセス
    画面->>ユーザー: ログイン画面表示
    ユーザー->>画面: ログイン情報入力・送信
    画面->>フロントエンド: ログイン情報送信
    フロントエンド->>バックエンド: ログイン認証リクエスト
    バックエンド->>DB: CUSTOMERテーブルで認証
    DB-->>バックエンド: 認証結果返却
    バックエンド-->>フロントエンド: 認証結果返却
    フロントエンド-->>画面: ログイン結果表示（成功なら商品一覧へ）

    ユーザー->>画面: 商品一覧閲覧要求
    画面->>フロントエンド: 商品一覧表示要求
    フロントエンド->>バックエンド: 商品情報取得リクエスト
    バックエンド->>DB: PRODUCT, CATEGORY, PRODUCT_IMAGE を検索
    DB-->>バックエンド: 商品情報返却
    バックエンド-->>フロントエンド: 商品情報返却
    フロントエンド-->>画面: 商品一覧表示

    ユーザー->>画面: 商品を選択し詳細を見る
    画面->>フロントエンド: 商品詳細取得要求
    フロントエンド->>バックエンド: 商品ID送信
    バックエンド->>DB: PRODUCTを検索
    DB-->>バックエンド: 商品詳細返却
    バックエンド-->>フロントエンド: 商品詳細返却
    フロントエンド-->>画面: 商品詳細表示

    ユーザー->>画面: 商品をカートに追加
    画面->>フロントエンド: カートに商品情報保持

    ユーザー->>画面: 購入手続きに進む
    フロントエンド->>バックエンド: 会員住所情報取得リクエスト
    バックエンド->>DB: CUSTOMERテーブルから住所情報を取得
    DB-->>バックエンド: 住所情報返却
    バックエンド-->>フロントエンド: 住所情報返却
    フロントエンド-->>画面: 住所選択フォームに表示
    画面->>フロントエンド: ユーザー情報入力
    フロントエンド->>バックエンド: 注文情報送信

    バックエンド->>DB: ORDERを登録（会員ID含む）
    バックエンド->>DB: ORDER_DETAILを商品ごとに登録
    DB-->>バックエンド: 登録成功通知
    バックエンド-->>フロントエンド: 注文完了情報返却
    フロントエンド-->>画面: 注文完了画面表示

</div>

##### **1. サイトアクセス～ログイン**

1. **画面（SC0001）**
   ユーザーがブラウザでECサイトにアクセスし、ログイン画面を表示。
2. **画面（SC0001）**
   ユーザーがログイン画面でメールアドレスとパスワードを入力し送信。
3. **アプリケーション（Backend）**
   送信された情報をもとにDBの会員情報を照合し、認証結果を返す。

##### **2. 商品選択～カート操作**

1. **アプリケーション（Frontend）**
   商品一覧を表示するためのリクエストをバックエンドへ送信。
2. **アプリケーション（Backend）**
   `PRODUCT` テーブルから商品情報を取得。
   必要に応じて `CATEGORY`, `PRODUCT_IMAGE` をJOIN。
   フロントエンドに商品情報を返却。
3. **画面（SC0110）**
   商品一覧が表示され、ユーザーが商品をクリック。
4. **アプリケーション（Frontend）**
   選択された商品IDで `PRODUCT` の詳細を取得し、商品詳細ページを表示。
5. **画面（SC0120）**
   商品詳細ページで数量を選び、「カートに追加」ボタンをクリック。
6. **アプリケーション（Frontend）**
   商品ID・数量をローカルセッションに保持。
   「カートを見る」ボタンでカート内容表示。

##### **3. 注文手続き（会員登録住所の取得）**

1. **画面（SC0140）**
   注文手続き画面に遷移。
2. **アプリケーション（Frontend）**
   会員が登録している住所情報を取得するリクエストを送信。
3. **アプリケーション（Backend）**
   `CUSTOMER` テーブルからログイン済み会員の住所情報を取得。
4. **画面（SC0140）**
   取得した登録住所が注文フォームに表示され、ユーザーが選択。

##### **4. 注文確定処理**

1. **画面（SC0150）**
   決済情報を入力後、注文内容を確認し「注文を確定する」ボタンをクリック。
2. **アプリケーション（Backend）**
   `ORDER`テーブルに注文基本情報（会員ID含む）を登録。`ORDER_DETAIL`テーブルに商品ごとの注文情報を登録。
3. **データベース（DB）**
   `ORDER`, `ORDER_DETAIL`に情報を登録。
4. **アプリケーション（Backend）**
   注文完了情報をフロントエンドへ返却。
5. **画面（SC0160）**
   注文完了画面を表示。

#### 例：商品情報の新規登録（管理者）

##### データフロー（シーケンス図）

<div class="mermaid">
sequenceDiagram
    participant 管理者
    participant 管理画面
    participant フロントエンド
    participant バックエンド
    participant DB

    管理者->>管理画面: ログイン画面にアクセス
    管理画面->>フロントエンド: ログイン情報入力送信
    フロントエンド->>バックエンド: ログイン認証リクエスト
    バックエンド->>DB: ADMIN テーブル照合
    DB-->>バックエンド: 認証結果返却
    バックエンド-->>フロントエンド: 認証結果返却
    フロントエンド-->>管理画面: ログイン結果表示（成功なら管理者ダッシュボード画面へ）

    管理者->>管理画面: 商品情報追加・編集画面に遷移
    管理画面->>フロントエンド: 商品情報・画像URL入力
    フロントエンド->>バックエンド: 商品登録リクエスト

    バックエンド->>DB: PRODUCTテーブルへ商品情報登録
    バックエンド->>DB: PRODUCT_IMAGEテーブルへ画像情報登録
    DB-->>バックエンド: 登録成功レスポンス
    バックエンド-->>フロントエンド: 登録完了レスポンス
    フロントエンド-->>管理画面: 商品登録完了表示

</div>

1. **画面（SC9001）**
   管理者がログイン画面にアクセスし、IDとパスワードを入力して「ログイン」ボタンをクリック。
2. **アプリケーション（Backend）**
   ログイン情報を受け取り、`ADMIN`テーブルで認証。認証成功の場合は管理者ダッシュボード画面へ遷移。
3. **画面（SC9101）**
   管理者ダッシュボード画面に遷移し、商品情報追加・編集画面へのリンクをクリック。
4. **画面（SC9201）**
   商品情報追加・編集画面で新規商品の情報（商品名、価格、カテゴリ、説明など）を入力し商品画像ファイルと表示順を選択。
5. **アプリケーション（Backend）**
   受け取った商品情報を `PRODUCT`テーブルに登録。
   画像ファイル情報を `PRODUCT_IMAGE`テーブルに登録。
6. **データベース（DB）**
   `PRODUCT`, `PRODUCT_IMAGE`に情報を登録。
7. **アプリケーション（Backend）**
   登録成功の結果を画面に返却。
8. **画面（SC9201）**
   商品登録完了のメッセージを表示。

### 5.4 拡張機能（決済と配送のステータス管理・在庫管理・購入履歴・レビュー・お気に入り・問い合わせ・管理者変更ログ）

#### 5.4.1 概念データモデル（ER図）

<div class="mermaid">
erDiagram
    CUSTOMER ||--o{ ORDER : "places"
    ORDER ||--|{ ORDER_DETAIL : "has"
    ORDER ||--|| PAYMENT : "includes"
    ORDER_DETAIL }|--|| PRODUCT : "includes"
    PRODUCT }|--|| CATEGORY : "belongs to"
    PRODUCT ||--o{ PRODUCT_IMAGE : "has"
    ORDER ||--|| SHIPPING : "has"
    ADMIN ||--o{ ADMIN_LOG : "makes"

    PRODUCT ||--|| INVENTORY : "has"
    CUSTOMER ||--o{ PURCHASE_HISTORY : "has"
    CUSTOMER ||--o{ REVIEW : "writes"
    CUSTOMER ||--o{ FAVORITE : "favorites"
    CUSTOMER ||--o{ INQUIRY : "makes"
    INQUIRY ||--o{ INQUIRY_RESPONSE : "has"
    ADMIN ||--o{ INQUIRY_RESPONSE : "writes"
    CUSTOMER ||--o{ INQUIRY_RESPONSE : "writes"

    PURCHASE_HISTORY }|--|| ORDER : "refers"
    REVIEW }|--|| PRODUCT : "reviews"
    FAVORITE }|--|| PRODUCT : "favorites"

    CUSTOMER {
        string 会員ID PK
        string 氏名
        string メールアドレス
        string ハッシュパスワード
        string 住所
        datetime 登録日時
        boolean メンバーシップ
    }

    ADMIN {
        string 管理者ID PK
        string 氏名
        string メールアドレス
        string ハッシュパスワード
        datetime 登録日時
    }

    ORDER {
        string 注文ID PK
        string 会員ID FK
        string 氏名
        string メールアドレス
        string 住所
        datetime 注文日時
        decimal 合計金額
        string 注文ステータス
    }

    ORDER_DETAIL {
        string 注文詳細ID PK
        string 注文ID FK
        string 商品ID FK
        int 数量
        decimal 単価
    }

    PRODUCT {
        string 商品ID PK
        string 商品名
        string 商品説明
        decimal 価格
        string カテゴリID FK
    }

    CATEGORY {
        string カテゴリID PK
        string カテゴリ名
    }

    PRODUCT_IMAGE {
        string 画像ID PK
        string 商品ID FK
        string 画像URL
        int 表示順
    }

    SHIPPING {
        string 配送ID PK
        string 注文ID FK
        string 氏名
        string 配送先住所
        decimal 送料
        string 配送ステータス
    }

    ADMIN_LOG {
        string ログID PK
        string 管理者ID FK
        string 操作内容
        datetime 操作日時
    }

    PAYMENT {
        string 決済ID PK
        string 注文ID FK
        string 決済方法
        string 決済状況
    }

    INVENTORY {
        string 在庫ID PK
        string 商品ID FK
        int 在庫数
        datetime 最終更新日時
    }

    PURCHASE_HISTORY {
        string 履歴ID PK
        string 会員ID FK
        string 注文ID FK
        datetime 購入日時
        decimal 購入金額
    }

    REVIEW {
        string レビューID PK
        string 会員ID FK
        string 商品ID FK
        int 評価
        string コメント
        datetime 投稿日時
    }

    FAVORITE {
        string お気に入りID PK
        string 会員ID FK
        string 商品ID FK
        datetime 登録日時
    }

    INQUIRY {
        string 問い合わせID PK
        string 会員ID FK
        string メールアドレス
        string 内容
        datetime 送信日時
        string 対応状態
    }

    INQUIRY_RESPONSE {
        string 返信ID PK
        string 問い合わせID FK
        string 返信者種別
        string 返信者ID
        string 内容
        datetime 返信日時
    }

</div>

- **エンティティ**

  - CUSTOMER（顧客）
  - ADMIN（管理者）
  - ORDER（注文）
  - ORDER_DETAIL（注文詳細）
  - PRODUCT（商品）
  - CATEGORY（カテゴリ）
  - PRODUCT_IMAGE（商品画像）
  - SHIPPING（配送情報）
  - PAYMENT（決済情報）
  - ADMIN_LOG（管理者ログ）
  - INVENTORY（在庫）
  - REVIEW（レビュー）
  - FAVORITE（お気に入り）
  - INQUIRY（問い合わせ）
  - INQUIRY_RESPONSE（問い合わせ返信）
- **リレーション**

  - 顧客は注文を行う（1対多、CUSTOMER → ORDER）
  - 注文は複数の注文詳細を持つ（1対多、ORDER →  ORDER_DETAIL）
  - 注文は配送情報を持つ（1対1、ORDER → SHIPPING）
  - 注文は決済情報を持つ（1対1、ORDER → PAYMENT）
  - 注文詳細は商品を含む（多対1、ORDER_DETAIL → PRODUCT）
  - 商品はカテゴリに属する（多対1、PRODUCT → CATEGORY）
  - 商品は複数の画像を持つ（1対多、PRODUCT → PRODUCT_IMAGE）
  - 商品は在庫情報を持つ（1対1、PRODUCT → INVENTORY）
  - 顧客は購入履歴を持つ（1対多、CUSTOMER → PURCHASE_HISTORY）
  - 購入履歴は注文を参照する（多対1、PURCHASE_HISTORY → ORDER）
  - 顧客は商品にレビューを投稿できる（1対多、CUSTOMER → REVIEW、PRODUCT → REVIEW）
  - 顧客は商品をお気に入り登録できる（1対多、CUSTOMER → FAVORITE、PRODUCT → FAVORITE）
  - 顧客は問い合わせを送ることができる（1対多、CUSTOMER → INQUIRY）
  - 管理者は操作ログを記録する（1対多、ADMIN → ADMIN_LOG）
  - 管理者は問い合わせに返答することができる（1対多、ADMIN → INQUIRY_RESPONSE）
  - 顧客は管理者の返答にさらに返答できる（1対多、CUSTOMER → INQUIRY_RESPONSE）

#### 5.4.2 主要テーブル概要

- **CUSTOMER（顧客テーブル）**

  - ECサイトの会員情報を管理。
  - 会員IDを主キーとし、顧客全員の情報を保持。
  - 氏名、メールアドレス、ハッシュ化パスワード、住所、登録日時、メンバーシップを保持。
  - 非会員の場合は、注文時に入力した情報を注文時にパスワードはNULL、メンバーシップはfalseとして保持。
  - 会員登録が任意のため、注文時の氏名・住所は注文テーブルにも保持し配送情報と連携。
- **ADMIN（管理者テーブル）**

  - ECサイトの管理者情報を管理。
  - 管理者IDを主キーとして管理。
  - 氏名、メールアドレス、ハッシュ化パスワード、登録日時を保持。
- **ORDER（注文テーブル）**

  - 顧客の注文情報を管理。
  - 注文IDを主キーとし、会員IDは外部キーとして関連付ける。
  - 注文日時、合計金額、注文ステータス、注文時の氏名・メールアドレス・住所を保持し配送や請求の基礎情報とする。
- **ORDER_DETAIL（注文詳細テーブル）**

  - 各注文に含まれる商品ごとの詳細情報を管理。
  - 注文詳細IDを主キー、注文IDと商品IDを外部キーとして紐付け。
  - 数量、単価を保持し、複数商品の注文に対応。
- **PRODUCT（商品テーブル）**

  - ECサイトで販売する商品の情報を管理。
  - 商品IDを主キーとし、商品名、商品説明、価格を保持、外部キーとしてカテゴリIDを紐づけ。
  - 商品画像と関連付ける。
- **CATEGORY（カテゴリテーブル）**

  - 商品の分類情報を管理。
  - カテゴリIDを主キーとし、カテゴリ名を保持。
- **PRODUCT_IMAGE（商品画像テーブル）**

  - 商品に紐づく複数の画像情報を管理。
  - 画像IDを主キーとし、商品IDを外部キーとして紐付け。
  - 画像URL、表示順を保持。
- **INVENTORY（在庫テーブル）**

  - 在庫ID（PK）、商品ID（FK）、在庫数、更新日時を保持。
  - 商品との1対1関係を持ち、購入時に自動減少。
  - 入荷の場合は管理画面から在庫数を入力。
- **SHIPPING（配送情報テーブル）**

  - 注文ごとの配送に関する情報を管理。
  - 配送IDを主キー、注文IDを外部キーとして紐付け。
  - 氏名、配送先住所、配送ステータス、送料を保持。
- **PAYMENT（決済情報テーブル）**

  - 注文に紐づく支払い情報を管理。
  - 決済IDを主キー、注文IDを外部キーとして紐付け。
  - 決済方法、決済ステータスを保持。
  - 初期リリースでは振込・代引きを想定。
- **REVIEW（レビュー情報テーブル）**

  - レビューID（PK）、会員ID（FK）、商品ID（FK）、評価（数値）、コメント、投稿日を保持。
  - 会員1名につき同一商品へのレビューは1件までを原則とする。
- **FAVORITE（お気に入りテーブル）**

  - お気に入りID（PK）、会員ID（FK）、商品ID（FK）、登録日時を保持。
  - 重複登録を防ぐため、会員IDと商品IDの組み合わせにユニーク制約を付与可能。
- **INQUIRY（問い合わせテーブル）**

  - 問い合わせID（PK）、会員ID（FK, NULL許容）、メールアドレス、内容、対応ステータス、問い合わせ日時を保持。
  - 未ログインのユーザーも問い合わせ可能。
- **INQUIRY_RESPONSE（問い合わせ返信テーブル）**

  - 返信ID（PK）、問い合わせID（FK）、返信者種別（"admin"または"customer"）、返信者ID、内容、返信日時を保持。
  - 問い合わせに対する複数の返信を保持し、顧客・管理者双方が返信可能。
- **ADMIN_LOG（管理者ログテーブル）**

  - 管理者による操作履歴を管理。
  - ログIDを主キー、管理者IDを外部キーとして紐付け。
  - 操作内容、操作日時を保持。

## 6. 非機能要件 対応方針

### 6.1. 性能

- **レスポンスタイム**: 商品一覧、商品詳細、カート操作など、主要画面において通常時（同時接続100ユーザー程度）での応答時間を3秒以内とする。
- **同時接続ユーザー数**: 想定ピーク時の同時接続は最大100ユーザー程度。
- **対応方針**:
  - 商品一覧など大量データが表示される画面では無限スクロール方式を採用。
  - データベースには適切なインデックスを設定し、クエリの最適化を行う。
  - アプリケーション・DBサーバーのスペックは負荷試験結果に応じて選定。クラウド環境のスケーリングも視野に入れる。
  - 必要に応じてキャッシュ導入を検討（例：カテゴリ一覧など更新頻度が低いもの）。

### 6.2. セキュリティ

- **認証・認可**:
  - 会員登録は任意。登録時には名前、住所、メールアドレス、パスワードを入力し、サーバー側で安全にハッシュ化して保存。
  - ログイン／ログアウト機能を提供し、マイページで会員情報の編集が可能。
  - セッション管理によりログイン状態を維持し、一定時間操作がない場合は自動ログアウト。
  - ユーザーと管理者のロールを分離し、管理機能（商品管理）は管理者のみ利用可。
  - **二要素認証について**
    本システムでは現時点で二要素認証は実装しないが、今後のセキュリティ要件の変化やリスク評価に応じて、導入の可能性がある。
    将来的に導入する場合は別途要件定義および設計検討を行うものとする。
- **通信の暗号化**:
  - Webアプリケーションは常時HTTPS（TLS1.2以上）を利用。
- **入力値の検証**:
  - すべてのユーザー入力についてサーバー側で形式・文字種・長さなどのバリデーションを実施。
  - SQLインジェクション対策としてプリペアドステートメント／エスケープ処理を使用。
  - クロスサイトスクリプティング（XSS）対策として、入力時／出力時にエスケープ処理を実施。
- **アクセス制御**:
  - URL直アクセスによる不正操作防止のため、サーバー側でのロール／権限チェックを実装。
- **その他**:
  - セッションID固定化の防止およびセッションタイムアウトの設定。
  - 使用ライブラリのセキュリティ脆弱性に対する定期的なチェックとアップデート。

### 6.3. 可用性

- **目標稼働率**:
  - 月間稼働率99.5%以上を目指す。
    ※ 99.5%の稼働率は約3.65日/月のダウンタイムに相当し、ECサイトとしてはやや低めの水準である。
    可能であれば99.9%以上（約43分/月）を目指すことが望ましいが、
    コスト制約や初期フェーズのリスク許容度を踏まえ、本数値を設定している。
    将来的なサービス拡大に伴い、稼働率向上の検討を行う。
- **対応方針**:
  - 初期は単一構成としつつも、障害時のバックアップ復旧手順を整備。
  - 必要に応じてWeb／DBの冗長化やマネージドサービスの高可用性オプションを検討。
  - データバックアップの取得とリストア手順を運用設計に含める。

### 6.4. その他（保守性、運用性、拡張性）

- **保守性**:
  - フレームワークの標準的な設計パターンに従い責務分離を実施。
  - 設定値は環境変数や設定ファイルで管理し、ハードコードを避ける。
- **運用性**:
  - システム稼働状況や障害発生をログで監視可能とする。
  - 定期メンテナンス（アップデート／ライブラリ更新）計画を策定。
- **拡張性**:
  - 将来的な機能追加や外部連携に備え、疎結合な設計とする。
  - 商品カテゴリは現時点では単一階層とするが、将来的に多階層カテゴリへの拡張を見据えたテーブル構成とする。
- **マイページ**:
  会員向けの専用画面を設置し、現時点では会員情報（名前、住所、メールアドレス、パスワード）の閲覧および編集機能を提供する。
  将来的な機能拡張（注文履歴の確認やポイント管理など）を見据え、拡張しやすい設計とする。

## 7. 運用・保守設計の概要

### 7.1. ログ設計方針

- **出力ログ**:
  - **アクセスログ**: リクエスト元IP、メソッド、パス、ステータスコード、処理時間など。
  - **アプリケーションログ**: 起動／停止、主要処理開始・終了、エラー（スタックトレース含む）。
  - **操作ログ（監査ログ）**: ユーザーのログイン／ログアウト、商品登録・削除・編集など。
- **ログレベル**:
  - DEBUG, INFO, WARN, ERROR を定義し、本番環境ではINFO以上を出力。
  - 【懸念事項】本番環境で詳細なDEBUGログを常時出力すると、システム負荷やパフォーマンス低下の可能性があるため、運用状況に応じてログレベルを切り替えることを推奨。
- **フォーマット**:
  - タイムスタンプ、ログレベル、メッセージ、ユーザーID、リクエストID等を含む。
- **保管期間**:
  - アクセスログ／アプリケーションログ: 最低1ヶ月。
  - 操作ログ: 最低1年間。
  - 【懸念事項】長期間のログ保存はストレージ容量の増加や管理コスト増大の懸念があるため、保存期間の見直しや定期的なログ削除・アーカイブ運用を検討することが望ましい。
- **ログ対象範囲**:
  - 重要な操作や管理者操作を中心にログ記録を行う。
  - 【懸念事項】すべてのユーザー操作を詳細に記録すると、プライバシー保護の観点やログ管理負担が増すため、ログ対象の範囲は必要最小限に絞ることを推奨。

### 7.2. 監視設計方針

- **監視項目**:

  - CPU使用率
  - メモリ使用率
  - ネットワークトラフィック
  - ディスク使用率（例: 80%以上でアラート）
  - アプリケーションログのエラー検知
  - データベースの稼働状況
- **監視方法**:

  - Zabbix、Nagios、Prometheus+Grafana 等の監視ツールを導入。
  - 閾値超過や異常発生時には、管理者にメールやチャットツール等で通知。
- #### 7.2.1 閾値の定義（主要項目）

| 項目               | 閾値                  | 備考                                       |
| ------------------ | --------------------- | ------------------------------------------ |
| CPU使用率          | 80%以上（5分間継続）  | 短時間のバーストは許容                     |
| メモリ使用率       | 90%以上               | スワップ発生の前段階で通知                 |
| ディスク使用率     | 85%以上               | ログやファイルアップロード増加に備えて監視 |
| HTTP応答時間       | 3秒超                 | 商品一覧・詳細ページなど主要画面が対象     |
| エラーログ出力数   | 10件/分以上           | ERRORレベル以上のログを対象                |
| HTTP 5xxエラー率   | 5%以上（直近1分平均） | 500番台エラーの比率                        |
| DB接続失敗回数     | 3回以上/分            | 瞬間的な断絶も検知                         |
| サーバー再起動検出 | 発生時に即時通知      | 想定外のクラッシュなどを検知               |

- **閾値の調整**:
  上記のエラーログ出力数（10件/分以上）およびHTTP 5xxエラー率（5%以上）の閾値は、
  初期設定値として設定しているが、運用開始後の実際のログ状況やシステム負荷を踏まえて柔軟に見直し・調整を行うことを想定する。

### 7.3. バックアップ・リカバリ方針

- **バックアップ対象**: DB全体、アップロードファイル、設定ファイルなど。
- **方式／頻度**:
  - 日次でフルバックアップ、必要に応じてトランザクションログのバックアップ。
  - 取得タイミングは深夜帯を想定。
- **保管場所／期間**:
  - バックアップは本番とは別環境（クラウドストレージ等）に保存。
  - 日次：直近7日、週次：4週分、月次：6ヶ月分を保持。
- **復旧手順**:
  - 復旧手順は文書化し、定期的にリストアテストを実施。
  - RTO（目標復旧時間）および RPO（目標復旧時点）を定める。

## 8. 制約事項・前提条件

### 8.1. 使用技術スタック

- **言語**: Java 17
- **フレームワーク**: Spring Boot 3.x
- **データベース**: MySQL 8.0
- **フロントエンド**: HTML5, CSS3, JavaScript(ES6)
- **Webサーバー**: Nginx
- **その他ライブラリ**: Spring Boot標準のスターターやSpring Data JPA等を中心に選定予定

### 8.2. インフラ環境

- **サーバーOS**: Ubuntu 22.04 LTS（予定）
- **実行環境**: Java対応のアプリケーションサーバー（例：Tomcat、WildFlyなどを検討中）
- **稼働場所**: クラウド環境（AWS EC2/RDSなどを想定）
- **ネットワーク**: インターネット経由でのアクセスを前提とする
  - 会社内LANや社内限定VPN環境ではなく、外部ユーザーもアクセス可能な環境を想定
  - セキュリティ対策として以下を実施予定
    - HTTPS強制（TLS1.2以上の利用）
    - AWS WAFを利用したWebアプリケーションファイアウォール設置
    - CloudflareによるDDoS攻撃対策
    - 認証・認可の強化（ロール分離、アクセス制御の厳格化）

### 8.3. 開発・運用ルール

- **バージョン管理**: Git（GitHub、GitLab想定）。ブランチ戦略はGit-Flowベースにて運用
- **コーディング規約**: Java標準コーディング規約に準拠。静的解析ツール（Checkstyle、SpotBugs等）によるコード品質管理を行う
- **テスト**: JUnitによる単体テストおよび統合テストを実施
- **デプロイ**: CI/CD環境による自動デプロイを検討・構築予定

### 8.4. スコープ外

- 外部サービスとのAPI連携（例：決済、配送業者連携）
- モバイルアプリの開発
- 詳細なテスト仕様書および運用マニュアルの作成

### 8.5. その他前提条件

- 会員登録は任意とし、登録時にはユーザーID、名前、住所、メールアドレス、パスワードを入力。パスワードはサーバー側で安全にハッシュ化して保存
- ユーザーと管理者のロールを明確に分離し、管理機能（商品管理）は管理者のみ利用可能とする
- 商品一覧画面は無限スクロール方式を採用し、ユーザビリティを向上させる
- 商品価格は商品ごとに設定可能とし、送料は全国一律700円とする
- 本システムは受注販売形式を採用し、配送フローが開始される設計とする
- 初期商品データはCSVファイルによってインポートする
- 開発・運用時のログ出力は膨大になる可能性があり、将来的にはログ保管コストやサーバーの稼働状況に応じて適切な保守・メンテナンス計画を策定予定

## 9. （付録）用語集・略語リスト

## 用語集

| 用語／略語                   | 定義・説明                                                                                                                                     |
| ---------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| **ECサイト**           | Electronic Commerce（電子商取引）サイトの略。インターネット上で商品やサービスを販売するウェブサイト。                                          |
| **カート機能**         | ユーザーが購入したい商品を一時的に保存し、まとめて注文できる機能。                                                                             |
| **商品詳細ページ**     | 商品の写真、説明、価格、素材、納期情報などの情報を表示するページ。                                                                             |
| **スマートフォン対応** | スマートフォンなどのモバイル端末でも快適に閲覧・操作できるようにする対応。                                                                     |
| **会員登録機能**       | ユーザーが個人情報を登録し、住所入力の簡略化などの利便性を得られる機能。                                                                       |
| **カテゴリ分類**       | 商品を種類ごとに分類し、ユーザーが探しやすくする仕組み。                                                                                       |
| **注文機能**           | ユーザーが商品を購入するための手続きを行う機能。                                                                                               |
| **レビュー機能**       | ユーザーが購入した商品に対して評価やコメントを投稿できる機能。                                                                                 |
| **決済機能**           | クレジットカードや電子マネーなどを使ってオンラインで代金を支払う機能。                                                                         |
| **無限スクロール**     | ページの下部までスクロールすると自動的に次のコンテンツが読み込まれる仕組み。ユーザーがページ切り替え操作をする必要がなく、連続的に閲覧できる。 |
| **API**                | Application Programming Interface。アプリケーションが他のソフトウェア機能やサービスを呼び出すためのインターフェース。                          |
| **CSV**                | Comma-Separated Values。カンマ区切りのテキスト形式で、表形式データを保存・交換する際によく用いられる。                                         |
| **DB**                 | Database（データベース）。本システムでは MySQL を指し、顧客情報や商品・注文などを管理。                                                        |
| **ER図**               | Entity-Relationship Diagram。システム内のエンティティ（表）とその関係を図示するモデル。                                                        |
| **HTTP / HTTPS**       | Hypertext Transfer Protocol。HTTPSはTLSで暗号化されたHTTP通信。API 呼び出しや画面表示に使用。                                                  |
| **JSON**               | JavaScript Object Notation。軽量なデータ交換フォーマット。REST API の入出力によく使われる。                                                    |
| **Spring Boot**        | Java製のWebアプリケーションフレームワーク。本システムのバックエンド開発に使用。                                                                |
| **RDBMS**              | Relational Database Management System。関係データベース管理システム。MySQL 8.0 を利用。                                                        |
| **REST API**           | Representational State Transfer に基づく API。HTTP メソッドで操作を行う。                                                                      |
| **SSO**                | Single Sign-On。一度のログインで複数の関連サービスにアクセス可能とする仕組み。                                                                 |
| **UI / UX**            | User Interface / User Experience。ユーザー操作画面の設計と利用体験全体の品質を示す。                                                           |
| **バリデーション**     | 入力値の妥当性チェック。形式・必須・文字数などを確認し、不正入力を防ぐ。                                                                       |
| **マイページ**         | 会員ユーザーが自分の登録情報を確認・変更できる専用画面。                                                                                       |
| **MySQL**              | オープンソースの関係型データベース管理システム。バージョン 8.0 を使用。                                                                        |
| **リレーショナルDB**   | テーブル間のリレーション（関係）を基本とした、関係モデル形式のデータベース。                                                                   |

## 10. 承認

本基本設計書の内容を、以下の関係者が承認する。
後続フェーズでの設計変更が発生した場合、変更管理のプロセスに従い本書を改訂し、バージョン管理を行う。

| 承認者           | 所属・役職                         | 日付       | 印 |
| :--------------- | :--------------------------------- | :--------- | :- |
| 田中　太郎  (甲) | 株式会社〇〇の事業企画部 部長      | 202X/XX/XX |    |
| 山田　一郎  (乙) | ベンダー　プロジェクトマネージャー | 202X/XX/XX |    |
| 佐藤　花子 (乙)  | ベンダー　システムエンジニア       | 202X/XX/XX |    |
