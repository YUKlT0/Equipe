E
## 6. 非機能要件 対応方針

### 6.1. 性能

- **レスポンスタイム**: 商品一覧、商品詳細、カート操作など、主要画面において通常時（同時接続10ユーザー程度）での応答時間を3秒以内とする。
- **同時接続ユーザー数**: 想定ピーク時の同時接続は最大100ユーザー程度。
- **対応方針**:
    - 商品一覧など大量データが表示される画面ではページネーション方式を採用し、1画面あたりの表示件数を制限。
    - データベースには適切なインデックスを設定し、クエリの最適化を行う。
    - アプリケーション・DBサーバーのスペックは負荷試験結果に応じて選定。クラウド環境のスケーリングも視野に入れる。
    - 必要に応じてキャッシュ導入を検討（例：カテゴリ一覧など更新頻度が低いもの）。

### 6.2. セキュリティ

- **認証・認可**:
    - 会員登録は任意。登録時には名前、住所、電話番号／メールアドレス、メルマガ購読希望有無を入力。
    - ユーザーと管理者のロールを分離し、管理機能（商品管理、在庫管理など）は管理者のみ利用可。
- **通信の暗号化**:
    - Webアプリケーションは常時HTTPS（TLS1.2以上）を利用。
- **入力値の検証**:
    - すべてのユーザー入力についてサーバー側で形式・文字種・長さなどをバリデーション。
    - SQLインジェクション対策としてプリペアドステートメント／エスケープ処理を使用。
    - クロスサイトスクリプティング（XSS）対策として、入力時／出力時のエスケープ処理を実施。
- **アクセス制御**:
    - URL直アクセスによる不正操作防止のため、サーバー側でのロール／権限チェックを実装。
- **その他**:
    - セッションID固定化の防止、セッションタイムアウトの設定。
    - 使用ライブラリのセキュリティ脆弱性に対する定期チェックとアップデート。

### 6.3. 可用性

- **目標稼働率**: 平日9:00〜18:00の営業時間内において、99.5%以上の稼働率を目指す。
- **対応方針**:
    - 初期は単一構成としつつも、障害時のバックアップ復旧手順を整備。
    - 必要に応じてWeb／DBの冗長化やマネージドサービスの高可用性オプションを検討。
    - データバックアップの取得とリストア手順を運用設計に含める。

### 6.4. その他（保守性、運用性、拡張性）

- **保守性**:
    - フレームワークの標準的な設計パターンに従い責務分離を実施。
    - 設定値は環境変数や設定ファイルで管理し、ハードコードを避ける。
- **運用性**:
    - システム稼働状況や障害発生をログで監視可能とする。
    - 定期メンテナンス（アップデート／ライブラリ更新）計画を策定。
- **拡張性**:
    - 将来的な機能追加や外部連携に備え、疎結合な設計とする。
    - 商品カテゴリは単一階層、追加による分類変更が可能なテーブル構成とする。

---

## 7. 運用・保守設計の概要

### 7.1. ログ設計方針

- **出力ログ**:
    - **アクセスログ**: リクエスト元IP、メソッド、パス、ステータスコード、処理時間など。
    - **アプリケーションログ**: 起動／停止、主要処理開始・終了、エラー（スタックトレース含む）。
    - **操作ログ（監査ログ）**: ユーザーのログイン／ログアウト、商品登録・削除・編集、在庫数更新など。
- **ログレベル**: DEBUG, INFO, WARN, ERROR を定義し、本番環境ではINFO以上を出力。
- **フォーマット**: タイムスタンプ、ログレベル、メッセージ、ユーザーID、リクエストID等を含む。
- **保管期間**:
    - アクセスログ／アプリケーションログ: 最低1ヶ月。
    - 操作ログ: 最低1年間。

### 7.2. 監視設計方針

- **監視項目**:
    - サーバーリソース（CPU、メモリ、ディスク容量、ネットワーク）。
    - Web／アプリケーション／DBプロセスの稼働有無。
    - HTTP/HTTPS応答による死活監視。
    - アプリケーションログ中のエラー検知。
- **監視方法**:
    - Zabbix、Nagios、Prometheus+Grafana 等の監視ツールを導入。
    - 閾値超過や異常発生時には、管理者にメールやチャットツール等で通知。

### 7.3. バックアップ・リカバリ方針

- **バックアップ対象**: DB全体、アップロードファイル、設定ファイルなど。
- **方式／頻度**:
    - 日次でフルバックアップ、必要に応じてトランザクションログのバックアップ。
    - 取得タイミングは深夜帯を想定。
- **保管場所／期間**:
    - バックアップは本番とは別環境（クラウドストレージ等）に保存。
    - 日次：直近7日、週次：4週分、月次：6ヶ月分を保持。
- **復旧手順**:
    - 復旧手順は文書化し、定期的にリストアテストを実施。
    - RTO（目標復旧時間）および RPO（目標復旧時点）を定める。

---

## 8. 制約事項・前提条件

### 8.1. 使用技術スタック

- **言語**: PHP 8.1（予定）
- **フレームワーク**: Laravel 10.x
- **データベース**: MySQL 8.0
- **フロントエンド**: HTML5, CSS3, JavaScript(ES6)
- **Webサーバー**: Nginx
- **その他ライブラリ**: Laravel標準パッケージを中心に選定予定

### 8.2. インフラ環境

- **サーバーOS**: Ubuntu 22.04 LTS（予定）
- **実行環境**: PHP-FPM
- **稼働場所**: クラウド環境（AWS EC2/RDS などを想定）
- **ネットワーク**: 社内LAN環境および社内限定VPN接続下での利用を想定

### 8.3. 開発・運用ルール

- **バージョン管理**: Git（GitLab想定）。ブランチ戦略としてGit-Flowをベースに運用。
- **コーディング規約**: LaravelのPSR-12に準拠。静的解析ツール（PHPStan等）でのチェックを行う。
- **テスト**: PHPUnitによるユニットテスト／統合テストを実施。
- **デプロイ**: CI/CD環境による自動デプロイを検討。

### 8.4. スコープ外

- 外部サービスとのAPI連携（例：決済、配送業者連携など）
- モバイルアプリの開発
- 詳細なテスト仕様書や運用マニュアル

### 8.5. その他前提条件

- 会員登録は任意。登録項目は氏名、住所、電話番号／メールアドレス、メルマガ有無。
- 商品カテゴリは「キッチン用具」「文房具」の2分類。単一階層。
- 商品一覧画面はページネーション方式を採用。
- 商品は一律300円。送料も全国一律300円とする。
- 在庫は商品ごとに数値で管理し、発注機能や棚卸し機能は対象外。
- バーコードリーダーはキーボード入力型（Enter付き）で、ドライバ不要のものを想定。
- 初期データはCSVファイルで提供
