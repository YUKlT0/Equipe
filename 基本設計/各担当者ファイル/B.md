B
## 3. 機能設計

### 3.1. 機能一覧

要件定義書に基づき、本システムが提供する機能を以下に示す。MoSCoW分類（Must / Should / Could / Won’t）も併記する。

| 機能ID | 機能名                   | 概要                                                                                         | MoSCoW | 備考                                                                                               |
|--------|--------------------------|----------------------------------------------------------------------------------------------|--------|----------------------------------------------------------------------------------------------------|
| F01    | ログイン/ログアウト機能   | 登録済みのユーザーが認証してログイン/ログアウトできる機能。                                 | Must   | JWTなどの認証方式を想定。ログイン状態はセッションまたはトークンで管理。                         |
| F02    | ユーザー情報登録機能     | 新規ユーザーが会員登録し、ユーザー情報をDBに登録する。                                     | Must   | メールアドレス、パスワード、氏名等を登録。                                                         |
| F03    | マイページ表示・編集機能 | ログインユーザーが登録済み情報を表示・変更できる機能。                                     | Should | 登録情報の編集・パスワード変更等。                                                                 |
| F04    | 商品一覧表示機能         | 商品をカテゴリ別に分類し、無限スクロールで一覧表示。                                       | Must   | 商品件数が多くてもUXを損なわないよう無限スクロールを実装。                                       |
| F05    | 商品詳細ページ表示       | 商品IDに紐づいた詳細情報（写真、価格、素材、納期予定など）を表示。                         | Must   | 商品IDによる動的ルーティング。画像複数対応も想定。                                                 |
| F06    | カテゴリ絞込   | カテゴリ別に商品を絞り込んで表示する。                                                     | Should | 簡易検索機能もCouldで対応可能。                                                                    |
| F07    | カート追加・削除機能     | 商品一覧または詳細から商品をカートに追加・削除できる機能。                                 | Must   | 商品ID、数量、価格などをカート情報に追加。                                                         |
| F08    | カート表示・数量編集機能 | カート内商品の一覧表示・数量の増減・削除ができる。                                         | Must   | 小計、合計金額も表示。                                                                               |
| F09    | カート状態保持機能       | セッション/ローカルストレージにより、未ログイン状態でもカート情報を保持。                   | Should   | ログイン後にサーバ側カートとマージする想定。                                                       |
| F10    | 注文情報入力             | 氏名・住所・連絡先などを入力するフォーム画面を表示。                                       | Must   | 会員は自動入力。非会員は手入力。                                                                   |
| F11    | 注文情報確認             | 入力内容・カート内容を最終確認する画面を表示。                                             | Must   | 注文内容、配送先情報などの確認。                                                                   |
| F12    | 注文確定                 | 確定ボタン押下時に注文情報をDBに登録。                                                     | Must   | 実際の決済処理は行わない。                                                                         |
| F13    | 注文完了表示             | 正常に注文が完了したことを伝える完了画面を表示。                                           | Must   | 注文番号などを表示。                                                                                |
| F14    | スマホUI最適化機能       | 各画面でレスポンシブデザインによりスマホでも最適表示されるよう対応。                       | Must   | スマホ特有のナビゲーションUIを適用（ハンバーガーメニュー等）。                                   |
| F15    | 商品情報管理機能         | 管理者が商品情報の追加・削除・編集を行う機能。                                             | Must   | 管理者認証後のみアクセス可能。                                                                     |
| F16    | 注文情報確認機能（管理者）| 管理者が注文情報を確認できる機能。                                                         | must | 商品発送管理などの発展機能のベースとして。                                                         |

---

**MoSCoW分類補足**

- **Must**: システム稼働に必要不可欠な機能
- **Should**: 優先度は高いが、なくても最低限の稼働は可能な機能
- **Could**: 余裕があれば実装したい機能
- **Won’t**: 今回のスコープ外の機能（将来的に検討）
  

### 3.2. 機能構成図

<div class="mermaid">
graph TD
    A[ECサイト全体]

    %% 各機能ノード
    A --> B[認証機能]
    A --> C[商品表示機能]
    A --> D[カート機能]
    A --> E[注文機能]
    A --> F[スマホ対応機能]
    A --> Z[管理者専用機能]

    %% 認証機能
    subgraph 認証機能
        B1[ログイン]
        B2[ログアウト]
        B3[ユーザー登録]
        B4[マイページ閲覧・編集]
    end
    B --> B1
    B --> B3
    B --> B4
    B --> B2

    %% 商品表示機能
    subgraph 商品表示機能
        C1[商品一覧]
        C2[カテゴリ別表示]
        C4[商品詳細]
    end
    C --> C1 --> C2 --> C4

    %% カート機能
    subgraph カート機能
        D1[商品追加・削除・数量変更]
        D2[カート内表示]
        D3[アイコン反映]
        D4[未ログインでも保持]
    end
    D --> D1 --> D2 --> D4
    D1 --> D3

    %% 注文機能
    subgraph 注文機能
        E1[個人情報入力（未ログイン時）]
        E2[入力確認]
        E3[注文確定]
        E4[注文ID・ステータス管理]
        E5[マイページからの注文（自動入力）]
    end
    E --> E1 --> E2 --> E3 --> E4
    B4 --> E5
    E5 --> E3
    %% スマホ対応機能
    subgraph スマホ対応機能
        F1[レスポンシブ最適化]
        F2[スマホ専用UI]
        F3[タップ優先レイアウト]
    end
    F --> F1
    F --> F2
    F --> F3

    %% 管理者機能
    subgraph 管理者専用機能
        G1[商品情報追加・削除]
        G2[商品編集]
        G3[注文情報確認]
    end
    Z --> G1
    Z --> G2
    Z --> G3

    %% フローとの整合リンク（コメント）
    B --> C
    B --> D
    B --> E

    C4 --> D1
    D4 --> E1

    F --> C
    F --> D
    F --> E
</div>

## 3.3. 主要機能フロー

システムで行われる代表的な業務フローを示す。

#### 3.3.1. ECサイト一般ユーザー利用フロー

<div class="mermaid">
sequenceDiagram
participant ユーザー as ECサイト利用者
participant サイト as ECサイト

alt 任意のタイミングでログイン
    ユーザー -->> サイト: ログイン
    サイト -->> ユーザー: 認証結果・マイページリンク表示
end

ユーザー ->> サイト: 商品ページにアクセス
サイト ->> ユーザー: 商品一覧を表示

ユーザー ->> サイト: 商品検索・カテゴリ選択
サイト ->> ユーザー: カテゴリ別商品一覧を表示

ユーザー ->> サイト: 商品を選択
サイト ->> ユーザー: 商品詳細ページを表示
ユーザー ->> サイト: 商品をカートに追加

alt 任意のタイミングでログイン
    ユーザー -->> サイト: ログイン
    サイト -->> ユーザー: 認証結果・マイページリンク表示
end

ユーザー ->> サイト: カート内容を確認
サイト ->> ユーザー: 商品一覧・金額を表示

ユーザー ->> サイト: 購入手続き開始（個人情報入力）
サイト ->> ユーザー: 入力確認画面を表示（キャンセル不可の注意あり）
ユーザー ->> サイト: 注文確定



</div>

#### 3.3.2. ECサイト管理者利用フロー
<div class="mermaid">
sequenceDiagram
participant 管理者 as 管理者
participant 管理画面 as 管理者画面
participant DB as ECサイト

alt 商品を新しく追加したいとき
    管理者 ->> 管理画面: 「新規商品追加」画面を開く
    管理者 ->> 管理画面: 商品名・価格・説明・画像を入力
    管理画面 ->> DB: 商品情報を登録
    DB ->> 管理画面: 登録成功レスポンス
    管理画面 ->> 管理者: 商品を追加しました
end

alt 商品情報を変更したいとき
    管理者 ->> 管理画面: 商品一覧から対象商品を選択
    管理者 ->> 管理画面: 編集内容を入力（例：価格、説明、画像など）
    管理画面 ->> DB: 商品情報を更新
    DB ->> 管理画面: 更新完了レスポンス
    管理画面 ->> 管理者: 商品情報を更新しました
end

alt 商品を削除（非公開）したいとき
    管理者 ->> 管理画面: 商品一覧から削除対象を選択
    管理者 ->> 管理画面: 「削除」または「公開停止」を実行
    管理画面 ->> DB: 対象商品を削除または非表示フラグを更新
    DB ->> 管理画面: 処理完了レスポンス
    管理画面 ->> 管理者: 商品を削除・非公開にしました
end
</div>
